@baseUrl = http://localhost:3000/api

# =================================================================
# TOKENS
# =================================================================
@token_admin = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBjcm0uY29tIiwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGUiOiJBRE1JTiIsImlhdCI6MTc1NDU2MDQ5MSwiZXhwIjoxNzU0NjQ2ODkxfQ.sXZekuDGiHv4_KVqCWM1Hz4bNyAh_bsRjYLIl7VRsfQ
@token_manager = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZW1haWwiOiJtYW5hZ2VyQGNybS5jb20iLCJ1c2VybmFtZSI6Im1hbmFnZXIiLCJyb2xlIjoiTUFOQUdFUiIsImlhdCI6MTc1NDU2MDUyNywiZXhwIjoxNzU0NjQ2OTI3fQ.MitFAC5XKFKW-a-Q5UWVEWjYMSO-acMANuNfKs5V1_w
@token_sales = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiZW1haWwiOiJzYWxlczFAY3JtLmNvbSIsInVzZXJuYW1lIjoic2FsZXMxIiwicm9sZSI6IlNBTEVTIiwiaWF0IjoxNzU0NTYwNTg3LCJleHAiOjE3NTQ2NDY5ODd9.2ZN-WQdAFyF_6BybSd31GFpD8FLMXPlLtEU1uZQh1aI
@token_sales2 = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NCwiZW1haWwiOiJzYWxlczJAY3JtLmNvbSIsInVzZXJuYW1lIjoic2FsZXMyIiwicm9sZSI6IlNBTEVTIiwiaWF0IjoxNzU0NTYwNjA1LCJleHAiOjE3NTQ2NDcwMDV9.WbemKaKO3luLZ_1ldluzfwwmszWq2q2fxL9Z7_gdSho


# =================================================================
# LEAD CORE ENDPOINTS
# =================================================================

### [SUCCESS] Sales user creates a new lead
# @name createLead
POST {{baseUrl}}/leads
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "Lead Prospek dari Website",
  "email": "prospek.website@example.com",
  "phone": "081211112222",
  "status": "NEW"
}

### ----------------------------------------------------------------

### [SUCCESS] Admin creates a lead with a customer ID
POST {{baseUrl}}/leads
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "name": "Lead dari Pelanggan Setia",
  "email": "lead.setia@example.com",
  "phone": "081233334444",
  "status": "CONTACTED",
  "customerId": 1
}

### ----------------------------------------------------------------

### [FAIL] Create lead with non-existent customer ID
POST {{baseUrl}}/leads
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "Lead Gagal",
  "email": "lead.gagal@example.com",
  "phone": "081255556666",
  "status": "NEW",
  "customerId": 9999
}

### ----------------------------------------------------------------

### [SUCCESS] Any authenticated user can get all leads
GET {{baseUrl}}/leads
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [SUCCESS] Any authenticated user can get a lead by ID
# Ganti ID sesuai dengan data yang ada
GET {{baseUrl}}/leads/1
Authorization: Bearer {{token_sales2}}

### ----------------------------------------------------------------

### [SUCCESS] Manager updates a lead
# Ganti ID sesuai dengan data yang ada
PATCH {{baseUrl}}/leads/1
Content-Type: application/json
Authorization: Bearer {{token_manager}}

{
  "status": "WON"
}

### ----------------------------------------------------------------

### [SUCCESS] Sales owner updates their own lead
# Ganti ID dengan lead yang dimiliki oleh token_sales
PATCH {{baseUrl}}/leads/1
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "Lead Prospek (Updated Name)"
}

### ----------------------------------------------------------------

### [FAIL] Sales user tries to update a lead they don't own
# Ganti ID dengan lead yang TIDAK dimiliki oleh token_sales2
PATCH {{baseUrl}}/leads/1
Content-Type: application/json
Authorization: Bearer {{token_sales2}}

{
  "status": "LOST"
}

### ----------------------------------------------------------------

### [SUCCESS] Admin deletes a lead
# Ganti ID lead jika perlu
DELETE {{baseUrl}}/leads/3
Authorization: Bearer {{token_admin}}


# =================================================================
# LEAD CONVERSION ENDPOINT
# =================================================================

### [SUCCESS] Sales owner converts their own lead
# @name convertLead
# Ganti ID dengan lead yang valid, belum dikonversi, dan dimiliki oleh token_sales
POST {{baseUrl}}/leads/5/convert
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [FAIL] Sales user tries to convert a lead they do not own
# Ganti ID dengan lead yang TIDAK dimiliki oleh token_sales2
POST {{baseUrl}}/leads/1/convert
Authorization: Bearer {{token_sales2}}

### ----------------------------------------------------------------

### [FAIL] Try to convert an already converted lead
# Ganti ID dengan lead yang SUDAH dikonversi
POST {{baseUrl}}/leads/2/convert
Authorization: Bearer {{token_sales}}


# =================================================================
# LEAD RELATIONSHIP ENDPOINTS
# =================================================================

### [SUCCESS] Any authenticated user gets opportunities for a lead
# Ganti ID dengan lead yang memiliki opportunity
GET {{baseUrl}}/leads/1/opportunities
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [SUCCESS] Any authenticated user gets activities for a lead
# Ganti ID dengan lead yang memiliki aktivitas
GET {{baseUrl}}/leads/1/activities
Authorization: Bearer {{token_manager}}

### ----------------------------------------------------------------

### [SUCCESS] Any authenticated user gets notes for a lead
# Ganti ID dengan lead yang memiliki catatan
GET {{baseUrl}}/leads/2/notes
Authorization: Bearer {{token_admin}}
