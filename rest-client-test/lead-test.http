@baseUrl = http://localhost:3000

### --- Token User: ADMIN ---
@token_admin = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBleGFtcGxlLmNvbSIsInVzZXJuYW1lIjoiYWRtaW51c2VyIiwicm9sZSI6IkFETUlOIiwiaWF0IjoxNzU0MTIxNzc4LCJleHAiOjE3NTQyMDgxNzh9.-UwNcJfFCD00ZvEPmEZ5HcItn5fVQfPaN53-dHKSx78

### --- Token User: SALES (ID: 2) ---
@token_sales = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZW1haWwiOiJzYWxlc0BleGFtcGxlLmNvbSIsInVzZXJuYW1lIjoic2FsZXN1c2VyIiwicm9sZSI6IlNBTEVTIiwiaWF0IjoxNzU0MTIxODEzLCJleHAiOjE3NTQyMDgyMTN9.Nw4jXZsNAfIRVXCE6pos-tApB5HIb5tDhMEhO0oYEmU
@token_sales2 = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiZW1haWwiOiJzYWxlczJAZXhhbXBsZS5jb20iLCJ1c2VybmFtZSI6InNhbGVzMnVzZXIiLCJyb2xlIjoiU0FMRVMiLCJpYXQiOjE3NTQxMjE4MjksImV4cCI6MTc1NDIwODIyOX0.LYgN6TBG4dnYCWUe-xtPQJVyjJ3hL7aQ-HVhND2Zd-U

### --- Token User: MANAGER (ID: 3) ---
@token_manager = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NCwiZW1haWwiOiJtYW5hZ2VyQGV4YW1wbGUuY29tIiwidXNlcm5hbWUiOiJtYW5hZ2VydXNlciIsInJvbGUiOiJNQU5BR0VSIiwiaWF0IjoxNzU0MTIxODUwLCJleHAiOjE3NTQyMDgyNTB9.NYtfyRMdopdq0f-tWagMDm9orpvMKVqGRKhlOjolXCY

### --- Token User: VIEWER (ID: 4) ---
@token_viewer = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwiZW1haWwiOiJ2aWV3ZXJAZXhhbXBsZS5jb20iLCJ1c2VybmFtZSI6InZpZXdlcnVzZXIiLCJyb2xlIjoiVklFV0VSIiwiaWF0IjoxNzU0MTIxODcxLCJleHAiOjE3NTQyMDgyNzF9.0ulog9GPO1wTYCqbZ243zQ4lr7aXClov_xn80mEPyrU

### Login untuk mendapatkan token
POST {{baseUrl}}/api/auth/login
Content-Type: application/json

{
  "emailOrUsername": "dummyuser",
  "password": "password123"
}

### Membuat pelanggan baru (opsional, untuk customerId pada Lead)
POST {{baseUrl}}/api/customers
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "John Doe",
  "email": "john.doe@example.com",
  "phone": "1234567890",
  "address": "123 Main St",
  "company": "Doe Inc"
}

### Membuat lead baru (kasus sukses, tanpa customerId)
POST {{baseUrl}}/api/leads
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "Alice Brown",
  "email": "alice.brown@example.com",
  "phone": "1234567890",
  "status" : "NEW"
}

### Membuat lead baru (kasus sukses, dengan customerId)
POST {{baseUrl}}/api/leads
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "name": "Jane Doe",
  "email": "jane.doe@example.com",
  "phone": "0987654321",
  "status": "CONTACTED",
  "customerId": 1
}

### Menguji customerId tidak valid (harus gagal)
POST {{baseUrl}}/api/leads
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "Charlie Black",
  "email": "charlie.black@example.com",
  "phone": "1112223333",
  "status": "NEW",
  "customerId": 999
}


### Menguji customerId bukan angka (harus gagal)
POST {{baseUrl}}/api/leads
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "name": "David White",
  "email": "david.white2@example.com",
  "phone": "1112223333",
  "status": "new",
  "customerId": "invalid"
}

### Menguji email tidak valid (harus gagal)
POST {{baseUrl}}/api/leads
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "name": "David White",
  "email": "invalid-email",
  "phone": "1112223333",
  "status": "new"
}

### Menguji tanpa token (harus gagal)
POST {{baseUrl}}/api/leads
Content-Type: application/json

{
  "name": "David White",
  "email": "david.white3@example.com",
  "phone": "1112223333",
  "status": "new"
}

### Mendapatkan semua lead
GET {{baseUrl}}/api/leads
Authorization: Bearer {{token_viewer}}

### Mendapatkan lead berdasarkan ID (kasus sukses)
GET {{baseUrl}}/api/leads/2
Authorization: Bearer {{token_viewer}}

### Mendapatkan lead dengan ID tidak valid (harus gagal)
GET {{baseUrl}}/api/leads/999
Authorization: Bearer {{token_viewer}}

### Memperbarui lead (kasus sukses, tanpa customerId)
PATCH {{baseUrl}}/api/leads/1
Content-Type: application/json
Authorization: Bearer {{token_manager}}

{
  "name": "Alice Brown Updated",
  "status": "CONTACTED"
}

### Memperbarui lead (kasus sukses, hapus customerId)
PATCH {{baseUrl}}/api/leads/2
Content-Type: application/json
Authorization: Bearer {{token_manager}}

{
  "customerId": null
}

### Menguji pembaruan dengan customerId tidak valid (harus gagal)
PATCH {{baseUrl}}/api/leads/1
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "customerId": 999
}

### Menguji pembaruan dengan customerId bukan angka (harus gagal)
PATCH {{baseUrl}}/api/leads/1
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "customerId": "invalid"
}

### Menghapus lead (kasus sukses)
DELETE {{baseUrl}}/api/leads/3
Authorization: Bearer {{token_admin}}

### Menghapus lead dengan ID tidak valid (harus gagal)
DELETE {{baseUrl}}/api/leads/999
Authorization: Bearer {{token_admin}}

###
### --- PENGUJIAN FITUR KONVERSI LEAD ---
###

### Membuat lead baru untuk dikonversi (dibuat oleh user sales)
POST {{baseUrl}}/api/leads
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "Convertable Lead",
  "email": "to.be.converted@example.com",
  "phone": "5551112222"
}

### Mengonversi lead (kasus sukses)
# Ganti ID dengan ID dari lead yang baru dibuat di atas
POST {{baseUrl}}/api/leads/6/convert
Authorization: Bearer {{token_sales}}

### Mengonversi lead (gagal, tidak berwenang)
# Pengguna sales2 mencoba mengonversi lead milik sales
POST {{baseUrl}}/api/leads/6/convert
Authorization: Bearer {{token_sales2}}

### Mengonversi lead (gagal, sudah dikonversi)
POST {{baseUrl}}/api/leads/6/convert
Authorization: Bearer {{token_sales}}

### Mengonversi lead (gagal, ID tidak ditemukan)
POST {{baseUrl}}/api/leads/9999/convert
Authorization: Bearer {{token_admin}}