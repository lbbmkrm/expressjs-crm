@baseUrl = http://localhost:3000/api

# =================================================================
# TOKENS
# =================================================================
@token_admin = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBjcm0uY29tIiwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGUiOiJBRE1JTiIsImlhdCI6MTc1NDU2MDQ5MSwiZXhwIjoxNzU0NjQ2ODkxfQ.sXZekuDGiHv4_KVqCWM1Hz4bNyAh_bsRjYLIl7VRsfQ
@token_manager = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZW1haWwiOiJtYW5hZ2VyQGNybS5jb20iLCJ1c2VybmFtZSI6Im1hbmFnZXIiLCJyb2xlIjoiTUFOQUdFUiIsImlhdCI6MTc1NDU2MDUyNywiZXhwIjoxNzU0NjQ2OTI3fQ.MitFAC5XKFKW-a-Q5UWVEWjYMSO-acMANuNfKs5V1_w
@token_sales = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiZW1haWwiOiJzYWxlczFAY3JtLmNvbSIsInVzZXJuYW1lIjoic2FsZXMxIiwicm9sZSI6IlNBTEVTIiwiaWF0IjoxNzU0NTYwNTg3LCJleHAiOjE3NTQ2NDY5ODd9.2ZN-WQdAFyF_6BybSd31GFpD8FLMXPlLtEU1uZQh1aI
@token_sales2 = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NCwiZW1haWwiOiJzYWxlczJAY3JtLmNvbSIsInVzZXJuYW1lIjoic2FsZXMyIiwicm9sZSI6IlNBTEVTIiwiaWF0IjoxNzU0NTYwNjA1LCJleHAiOjE3NTQ2NDcwMDV9.WbemKaKO3luLZ_1ldluzfwwmszWq2q2fxL9Z7_gdSho
@token_viewer = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwiZW1haWwiOiJ2aWV3ZXJAY3JtLmNvbSIsInVzZXJuYW1lIjoidmlld2VyIiwicm9sZSI6IlZJRVdFUiIsImlhdCI6MTc1NDU3NzE3MiwiZXhwIjoxNzU0NjYzNTcyfQ.0RWXzPpemALcQxD6oHUnG7BBSs0WA85ZSPcsOmlEtR0



# =================================================================
# NOTE CORE ENDPOINTS
# =================================================================

### [SUCCESS] Sales user creates a note for a CUSTOMER
# @name createNoteForCustomer
POST {{baseUrl}}/notes
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "content": "Diskusi awal dengan pelanggan mengenai kebutuhan mereka.",
  "customerId": 1
}

### ----------------------------------------------------------------

### [SUCCESS] Manager creates a note for a LEAD
# @name createNoteForLead
POST {{baseUrl}}/notes
Content-Type: application/json
Authorization: Bearer {{token_manager}}

{
  "content": "Lead menunjukkan minat tinggi pada produk X, perlu follow-up.",
  "leadId": 2
}

### ----------------------------------------------------------------

### [SUCCESS] Admin creates a note for an OPPORTUNITY
# @name createNoteForOpportunity
POST {{baseUrl}}/notes
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "content": "Proposal telah dikirim, menunggu feedback dari opportunity.",
  "opportunityId": 1
}

### ----------------------------------------------------------------

### [SUCCESS] Sales user creates a note for a CONTACT
# @name createNoteForContact
POST {{baseUrl}}/notes
Content-Type: application/json
Authorization: Bearer {{token_sales2}}

{
  "content": "Kontak meminta demo produk dijadwalkan minggu depan.",
  "contactId": 2
}

### ----------------------------------------------------------------

### [FAIL] Create a note with a non-existent LEAD ID
POST {{baseUrl}}/notes
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "content": "This should fail.",
  "leadId": 9999
}

### ----------------------------------------------------------------

### [FAIL] Create a note without any relation ID
POST {{baseUrl}}/notes
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "content": "This should fail as it has no relation."
}

### ----------------------------------------------------------------

### [FAIL] Create a note with multiple relation IDs
POST {{baseUrl}}/notes
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "content": "This should fail as it has multiple relations.",
  "customerId": 1,
  "leadId": 1
}

### ----------------------------------------------------------------

### [SUCCESS] Any authenticated user can get a note by ID
# Ganti ID sesuai dengan data yang ada
GET {{baseUrl}}/notes/1
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [SUCCESS] Sales owner updates their own note
# Ganti ID dengan note yang dimiliki oleh token_sales
PATCH {{baseUrl}}/notes/1
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "content": "(Updated) Diskusi awal dengan pelanggan mengenai kebutuhan mereka dan potensi upsell."
}

### ----------------------------------------------------------------

### [FAIL] Sales user tries to update a note they don't own
# Ganti ID dengan note yang TIDAK dimiliki oleh token_sales2
PATCH {{baseUrl}}/notes/1
Content-Type: application/json
Authorization: Bearer {{token_sales2}}

{
  "content": "Attempt to update failed."
}

### ----------------------------------------------------------------

### [SUCCESS] Admin can update any note
# Ganti ID note jika perlu
PATCH {{baseUrl}}/notes/2
Content-Type: application/json
Authorization: Bearer {{token_admin}}

{
  "content": "(Updated by Admin) Lead menunjukkan minat tinggi pada produk X."
}

### ----------------------------------------------------------------

### [SUCCESS] Sales owner deletes their own note
# Ganti ID dengan note yang dimiliki oleh token_sales
DELETE {{baseUrl}}/notes/1
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [FAIL] Manager tries to delete a note they don't own
# Ganti ID dengan note yang TIDAK dimiliki oleh token_manager
DELETE {{baseUrl}}/notes/4
Authorization: Bearer {{token_manager}}

### ----------------------------------------------------------------

### [SUCCESS] Admin can delete any note
# Ganti ID note jika perlu
DELETE {{baseUrl}}/notes/2
Authorization: Bearer {{token_admin}}
