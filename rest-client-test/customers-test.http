@baseUrl = http://localhost:3000/api

# =================================================================
# TOKENS
# Harap ganti dengan token yang valid sebelum menjalankan
# =================================================================
@token_admin = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MSwiZW1haWwiOiJhZG1pbkBjcm0uY29tIiwidXNlcm5hbWUiOiJhZG1pbiIsInJvbGUiOiJBRE1JTiIsImlhdCI6MTc1NDQ4MDIyNSwiZXhwIjoxNzU0NTY2NjI1fQ.PdEpZ1cklrgjnhBWeOpGyMZX_qGMsvTYTElm6nmWEpk
@token_manager = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MiwiZW1haWwiOiJtYW5hZ2VyQGNybS5jb20iLCJ1c2VybmFtZSI6Im1hbmFnZXIiLCJyb2xlIjoiTUFOQUdFUiIsImlhdCI6MTc1NDQ4MDU5MSwiZXhwIjoxNzU0NTY2OTkxfQ.y8SdUMGn9Ryan4Gy8zRrMS8a3aKCICofUixIubm4ahM
@token_sales = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6MywiZW1haWwiOiJzYWxlczFAY3JtLmNvbSIsInVzZXJuYW1lIjoic2FsZXMxIiwicm9sZSI6IlNBTEVTIiwiaWF0IjoxNzU0NDgwNjUyLCJleHAiOjE3NTQ1NjcwNTJ9.E1JlcS77BtxhL6ZulRM2ecxn8QeHrdRdeoMu2VZUKvs


# =================================================================
# CUSTOMER CORE ENDPOINTS
# =================================================================

### [SUCCESS] Sales user creates a new customer
# @name createCustomer
POST {{baseUrl}}/customers
Content-Type: application/json
Authorization: Bearer {{token_sales}}

{
  "name": "PT Maju Mundur Sejahtera",
  "email": "kontak@majumundur.com",
  "phone": "02177788899",
  "address": "Jl. Kenangan No. 404, Jakarta",
  "company": "MMS Group"
}

### ----------------------------------------------------------------

### [SUCCESS] Any authenticated user gets all customers
GET {{baseUrl}}/customers
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [SUCCESS] Any authenticated user gets a customer by ID
GET {{baseUrl}}/customers/1
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [SUCCESS] Manager updates a customer
PATCH {{baseUrl}}/customers/1
Content-Type: application/json
Authorization: Bearer {{token_manager}}

{
  "phone": "02177788811",
  "company": "Maju Mundur Sejahtera Tbk"
}

### ----------------------------------------------------------------

### [FAIL] Sales user tries to delete a customer (not allowed if have relation)
DELETE {{baseUrl}}/customers/3
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------

### [SUCCESS] Admin deletes a customer
# Ganti ID customer jika perlu
DELETE {{baseUrl}}/customers/4
Authorization: Bearer {{token_admin}}


# =================================================================
# CUSTOMER RELATIONSHIP ENDPOINTS
# =================================================================

### [SUCCESS] Manager gets all contacts for a customer
GET {{baseUrl}}/customers/1/contacts
Authorization: Bearer {{token_manager}}

### ----------------------------------------------------------------

### [SUCCESS] Manager gets all leads for a customer
GET {{baseUrl}}/customers/1/leads
Authorization: Bearer {{token_manager}}

### ----------------------------------------------------------------

### [SUCCESS] Manager gets all opportunities for a customer
GET {{baseUrl}}/customers/1/opportunities
Authorization: Bearer {{token_manager}}

### ----------------------------------------------------------------

### [SUCCESS] Manager gets all sales for a customer
GET {{baseUrl}}/customers/1/sales
Authorization: Bearer {{token_manager}}

### ----------------------------------------------------------------

### [SUCCESS] Manager gets all activities for a customer
GET {{baseUrl}}/customers/1/activities
Authorization: Bearer {{token_manager}}

### ----------------------------------------------------------------

### [FAIL] Sales user tries to get activities for a customer (not allowed by policy)
GET {{baseUrl}}/customers/1/activities
Authorization: Bearer {{token_sales}}

### ----------------------------------------------------------------
